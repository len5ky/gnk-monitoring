:8005 {
  reverse_proxy grafana:3000
}

:8445 {
  tls /etc/caddy/certs/ip.crt /etc/caddy/certs/ip.key
  reverse_proxy grafana:3000
}

:8006 {
  reverse_proxy loki:3100
}

:8446 {
  tls /etc/caddy/certs/ip.crt /etc/caddy/certs/ip.key
  basicauth {
    {$LOKI_INGEST_USER} {$LOKI_INGEST_PASS_HASH}
  }
  reverse_proxy loki:3100
}

# Prometheus (HTTP - local only)
:8007 {
  reverse_proxy prometheus:9090
}

# Prometheus UI (HTTPS with auth for web interface)
:8447 {
  tls /etc/caddy/certs/ip.crt /etc/caddy/certs/ip.key
  basicauth {
    {$PROMETHEUS_USER} {$PROMETHEUS_PASS_HASH}
  }
  reverse_proxy prometheus:9090
}

# Prometheus remote_write (HTTPS with auth for remote agents)
:8448 {
  tls /etc/caddy/certs/ip.crt /etc/caddy/certs/ip.key
  basicauth /api/v1/write {
    {$PROMETHEUS_USER} {$PROMETHEUS_PASS_HASH}
  }
  reverse_proxy prometheus:9090
}


